<!doctype html><html lang=en class=scroll-smooth><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Fetch GraphQL query from an Apollo client using APQ - Part 1 Â· Ish's Blog
</title><script src=https://cdn.tailwindcss.com></script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css><link rel=stylesheet href=https://ishabbi.tech/css/neobrutal.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous onload=renderMathInElement(document.body)></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta http-equiv=Content-Security-Policy content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self'; child-src 'self'; font-src 'self' https://fonts.gstatic.com https://cdn.jsdelivr.net/ https://cdnjs.cloudflare.com https://rookieintraining.github.io/ https://r2cdn.perplexity.ai; form-action 'self'; frame-src 'self' https://comments.app https://rookieintraining.github.io/ https://topmate.io; img-src 'self' https://*.googletagmanager.com https://rookieintraining.github.io/; object-src 'none'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com/ https://cdn.jsdelivr.net/ https://cdnjs.cloudflare.com https://cdn.tailwindcss.com https://rookieintraining.github.io/ https://topmate.io https://*.amazonaws.com; script-src 'self' 'unsafe-inline' https://*.google-analytics.com https://*.googletagmanager.com https://comments.app https://rookieintraining.github.io/ https://topmate.io https://*.amazonaws.com https://cdn.jsdelivr.net https://cdn.tailwindcss.com https://cdnjs.cloudflare.com; connect-src 'self' https://*.google-analytics.com https://*.analytics.google.com https://*.googletagmanager.com https://rookieintraining.github.io/;"><meta name=author content="Ish Abbi"><meta name=description content="Struggling to automate GraphQL APIs or fetch queries? Learn about APQ and how to intercept these requests in this guide to GraphQL automation."><meta name=keywords content="blog,developer,personal,testing,automation"><meta property="twitter:card" content="summary_large_image"><meta property="twitter:title" content="Fetch GraphQL query from an Apollo client using APQ - Part 1"><meta property="twitter:description" content="Struggling to automate GraphQL APIs or fetch queries? Learn about APQ and how to intercept these requests in this guide to GraphQL automation."><meta property="twitter:image" content="https://ishabbi.tech/images/debug-apq-1/apqd-banner-resized.png"><meta property="og:url" content="https://ishabbi.tech/posts/debug-apq-extension-part1/"><meta property="og:site_name" content="Ish's Blog"><meta property="og:title" content="Fetch GraphQL query from an Apollo client using APQ - Part 1"><meta property="og:description" content="Struggling to automate GraphQL APIs or fetch queries? Learn about APQ and how to intercept these requests in this guide to GraphQL automation."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-07-20T23:55:00+05:30"><meta property="article:modified_time" content="2024-07-20T23:55:00+05:30"><meta property="article:tag" content="Graphql"><meta property="article:tag" content="Apollo-Graphql"><meta property="article:tag" content="Apq"><meta property="article:tag" content="Chrome-Extensions"><meta property="article:tag" content="Debugging"><meta property="article:tag" content="Graphql-Queries"><meta property="og:see_also" content="https://ishabbi.tech/posts/debug-apq-extension-part2/"><meta property="og:image" content="https://ishabbi.tech/images/debug-apq-1/apqd-banner-resized.png"><link rel=canonical href=https://ishabbi.tech/posts/debug-apq-extension-part1/><link rel=icon type=image/svg+xml href=https://ishabbi.tech/icons/favicon.ico sizes=any><link rel=icon type=image/png href=https://ishabbi.tech/icons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://ishabbi.tech/icons/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=https://ishabbi.tech/icons/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=https://ishabbi.tech/icons/apple-touch-icon.png><link rel=manifest href=https://ishabbi.tech/icons/site.webmanifest><link rel=mask-icon href=https://ishabbi.tech/icons/safari-pinned-tab.svg color=#5bbad5><script>tailwind.config={theme:{extend:{colors:{"neon-pink":"#FF10F0","neon-blue":"#00F5FF","neon-green":"#39FF14","neon-yellow":"#FFFF00","brutal-black":"#000000","brutal-white":"#FFFFFF","brutal-red":"#FF0000","brutal-blue":"#0000FF","brutal-yellow":"#FFFF00","brutal-purple":"#8000FF","brutal-orange":"#FF8000"},fontFamily:{brutal:["Arial Black","Arial","sans-serif"]},boxShadow:{brutal:"8px 8px 0px 0px #000000","brutal-sm":"4px 4px 0px 0px #000000","brutal-lg":"12px 12px 0px 0px #000000","brutal-colored":"8px 8px 0px 0px"}}}}</script></head><body class="preload-transitions min-h-screen font-sans antialiased" style="background:linear-gradient(to bottom right,var(--bg-gradient-start),var(--bg-gradient-mid),var(--bg-gradient-end))"><div class="fixed inset-0 overflow-hidden pointer-events-none z-0"><div class="absolute top-20 left-10 w-32 h-32 bg-neon-pink rounded-lg rotate-12 opacity-20 animate-pulse"></div><div class="absolute top-40 right-20 w-24 h-24 bg-neon-blue rounded-lg -rotate-12 opacity-20 animate-pulse delay-300"></div><div class="absolute bottom-20 left-1/4 w-40 h-40 bg-neon-green rounded-lg rotate-45 opacity-20 animate-pulse delay-700"></div><div class="absolute bottom-40 right-1/3 w-28 h-28 bg-neon-yellow rounded-lg -rotate-45 opacity-20 animate-pulse delay-1000"></div></div><div class="relative z-10"><header class="sticky top-0 z-50 mb-8"><nav class="bg-white border-4 border-black shadow-brutal mx-4 md:mx-8 mt-4 md:mt-8"><div class="container mx-auto px-4 md:px-8 py-4"><div class="flex flex-col md:flex-row justify-between items-center gap-4"><a href=https://ishabbi.tech/ class="text-2xl md:text-3xl font-black text-black hover:text-neon-pink transition-all duration-300 transform hover:scale-105 block">Ish's Blog
</a><input type=checkbox id=menu-toggle class="hidden peer">
<label for=menu-toggle class="md:hidden bg-black text-white px-4 py-2 border-4 border-black shadow-brutal-sm cursor-pointer hover:bg-neon-pink hover:text-black transition-all duration-200"><i class="fa-solid fa-bars"></i></label><ul class="hidden md:flex peer-checked:flex flex-col md:flex-row gap-4 md:gap-6 w-full md:w-auto items-center mt-4 md:mt-0"><li><a href=https://ishabbi.tech/posts/ class="nav-link text-lg md:text-xl font-black text-black px-4 py-2 border-4 border-black bg-white hover:bg-neon-yellow hover:shadow-brutal-sm transition-all duration-200 inline-block transform hover:-translate-y-1">Blog</a></li><li><a href=https://ishabbi.tech/aboutme/ class="nav-link text-lg md:text-xl font-black text-black px-4 py-2 border-4 border-black bg-white hover:bg-neon-yellow hover:shadow-brutal-sm transition-all duration-200 inline-block transform hover:-translate-y-1">About</a></li><li><a href=https://ishabbi.tech/contactme/ class="nav-link text-lg md:text-xl font-black text-black px-4 py-2 border-4 border-black bg-white hover:bg-neon-yellow hover:shadow-brutal-sm transition-all duration-200 inline-block transform hover:-translate-y-1">Contact me</a></li></ul></div></div></nav></header><main class=content-wrapper><section class="container mx-auto px-4 md:px-8 py-12"><article class="max-w-6xl mx-auto"><header class="mb-12 animate-fade-in-up"><div class="featured-image-wrapper mb-8 animate-fade-in-up delay-200"><img src=https://ishabbi.tech/images/debug-apq-1/apqd-banner-resized.png alt="Fetch GraphQL query from an Apollo client using APQ - Part 1" class="w-full border-4 border-black shadow-brutal"></div><div class="bg-white border-4 border-black shadow-brutal p-8 md:p-12 mb-8"><h1 class="text-4xl md:text-6xl font-black text-black mb-6 leading-tight">Fetch GraphQL query from an Apollo client using APQ - Part 1</h1><div class="post-meta flex flex-wrap items-center gap-4 md:gap-6"><div class="flex items-center gap-2"><i class="fa-solid fa-calendar text-neon-pink"></i>
<time datetime=2024-07-20T23:55:00+05:30 class="font-bold text-black">July 20, 2024</time></div><div class="flex items-center gap-2"><i class="fa-solid fa-clock text-neon-blue"></i>
<span class="font-bold text-black"></span></div></div><div class="flex flex-wrap gap-3 mt-6"><a href=https://ishabbi.tech/categories/tools-for-automation/ class=category-tag><span class="bg-neon-blue text-black px-4 py-2 border-2 border-black font-black text-sm hover:bg-neon-yellow transition-colors">Tools for Automation
</span></a><a href=https://ishabbi.tech/tags/graphql/ class=tag-link><span class="bg-neon-green text-black px-3 py-1 border-2 border-black font-bold text-xs hover:bg-neon-yellow transition-colors">#Graphql
</span></a><a href=https://ishabbi.tech/tags/apollo-graphql/ class=tag-link><span class="bg-neon-green text-black px-3 py-1 border-2 border-black font-bold text-xs hover:bg-neon-yellow transition-colors">#Apollo-Graphql
</span></a><a href=https://ishabbi.tech/tags/apq/ class=tag-link><span class="bg-neon-green text-black px-3 py-1 border-2 border-black font-bold text-xs hover:bg-neon-yellow transition-colors">#Apq
</span></a><a href=https://ishabbi.tech/tags/chrome-extensions/ class=tag-link><span class="bg-neon-green text-black px-3 py-1 border-2 border-black font-bold text-xs hover:bg-neon-yellow transition-colors">#Chrome-Extensions
</span></a><a href=https://ishabbi.tech/tags/debugging/ class=tag-link><span class="bg-neon-green text-black px-3 py-1 border-2 border-black font-bold text-xs hover:bg-neon-yellow transition-colors">#Debugging
</span></a><a href=https://ishabbi.tech/tags/graphql-queries/ class=tag-link><span class="bg-neon-green text-black px-3 py-1 border-2 border-black font-bold text-xs hover:bg-neon-yellow transition-colors">#Graphql-Queries</span></a></div></div></header><div class="post-content bg-white border-4 border-black shadow-brutal p-8 md:p-12 mb-12 animate-fade-in-up delay-400"><div class="prose prose-xl md:prose-2xl max-w-none"><p><strong>APIs (Application Programming Interfaces)</strong> for web applications have evolved significantly since the early days of the internet. Initially, APIs were simple and used primarily for data exchange between server and client, often through protocols like SOAP (Simple Object Access Protocol). These early APIs were cumbersome and required extensive documentation and strict adherence to protocols.</p><p>The rise of <strong>REST (Representational State Transfer)</strong> in the early 2000s marked a major shift, offering a more flexible and scalable approach to building web APIs. RESTful APIs leverage standard HTTP methods, making them easier to use and more intuitive. However, 2015 saw a paradigm shift, Facebook (now Meta Inc.) introduced <strong>GraphQL</strong> to the world, allowing clients to request specific data, resulting to it&rsquo;s rapid adoption amongst enterprises. According to reports, it is projected that by 2025, <em>over 50% of enterprises will use GraphQL in production, up from less than 10% in 2021</em>.</p><hr><h2 id=graphql-101>Graphql 101</h2><p>For those who are new to GraphQL, I&rsquo;ll highlight some of the key concepts used below:</p><div class=graphql-concepts><div class=concepts-grid><div class=concept><h3 class=concept-title>Schema</h3><p class=concept-description>The schema defines the structure of the API, specifying types, queries, mutations, and subscriptions. It serves as a contract between the client and server.</p></div><div class=concept><h3 class=concept-title>Types</h3><p class=concept-description>GraphQL uses various types such as <span class=concept-tag>Scalar</span>, <span class=concept-tag>Object</span>, <span class=concept-tag>Enum</span>, <span class=concept-tag>Union</span>, and <span class=concept-tag>Interface</span> to define the shape of the data and the relationships between different data fields.</p></div><div class=concept><h3 class=concept-title>Queries</h3><p class=concept-description>Queries are used to fetch data from the server. They specify what data is needed and can include nested fields to retrieve related data in a single request.</p></div><div class=concept><h3 class=concept-title>Mutations</h3><p class=concept-description>Mutations are used to modify data on the server. They allow clients to perform actions like creating, updating, or deleting data.</p></div><div class=concept><h3 class=concept-title>Subscriptions</h3><p class=concept-description>Subscriptions enable real-time updates by allowing clients to listen for specific events and receive updates when those events occur.</p></div><div class=concept><h3 class=concept-title>Resolvers</h3><p class=concept-description>Resolvers are functions that handle the logic for fetching the data specified in queries, mutations, and subscriptions. They map schema fields to data sources.</p></div><div class=concept><h3 class=concept-title>Fields</h3><p class=concept-description>Fields are the individual pieces of data that can be queried within a type. Each field can have arguments, making the queries flexible and dynamic.</p></div><div class=concept><h3 class=concept-title>Arguments</h3><p class=concept-description>Arguments allow clients to pass parameters to fields, enabling the customization of the data fetched by queries and mutations.</p></div><div class=concept><h3 class=concept-title>Directives</h3><p class=concept-description>Directives provide a way to modify the behavior of queries, such as including or skipping fields based on conditions (<span class=concept-tag>@include</span> and <span class=concept-tag>@skip</span>).</p></div><div class=concept><h3 class=concept-title>Fragments</h3><p class=concept-description>Fragments allow the reuse of parts of queries and mutations. They help in structuring queries and reducing redundancy by defining reusable units of selection sets.</p></div><div class=concept><h3 class=concept-title>Introspection</h3><p class=concept-description>Introspection is a feature that allows clients to query the schema itself to understand the types, fields, and operations available, aiding in API exploration and documentation.</p></div></div></div><p>For further reading, you can go through the getting started present <a href=https://graphql.org/learn/>here</a></p><p>As discussed earlier, graphql&rsquo;s strengths is its ability to fetch exactly the data needed. This can however, also lead to issues if not managed correctly. Over-querying can occur if clients request too much data, impacting performance. Under-querying, where not enough data is requested, might require multiple requests to fulfill a need, which could negate some of the benefits of using GraphQLâ€‹.</p><p>Also, in order to avoid under and over-fetching, developers might resort to creating complex queries containing multiple fragments which increases the size of the payload that needs to be sent to the network which again impacts the performance of the application.</p><p>And this is where we are introduced to the <strong><em>Apollo Client</em></strong>.</p><hr><h2 id=apollo-client-and-apq>Apollo Client and APQ</h2><p>As per their current documentation:</p><blockquote>Apollo provides the developer platform and tools to unify your data and services into a supergraphâ€”a single distributed GraphQL API.
Apollo makes GraphQL work for you at any stage and any scale, whether you're just getting started, building your first API, querying an API, or migrating your platform onto the supergraph.</blockquote><p>Apollo GraphQL Client provides several features that help overcome the limitations of GraphQL, enhancing the development experience and performance of GraphQL-based applications. The discussion for which is limited to <strong>Automatic persisted queries or APQ</strong></p><blockquote>A persisted query is a query string that's cached on the server side, along with its unique identifier (always its SHA-256 hash). Clients can send this identifier instead of the corresponding query string, thus reducing request sizes dramatically (response sizes are unaffected).<p>To persist a query string, Apollo Server must first receive it from a requesting client. Consequently, each unique query string must be sent to Apollo Server at least once. After any client sends a query string to persist, every client that executes that query can then benefit from APQ.</p></blockquote><p>Now, this works wonders in boosting the performance of the application. But, does pose a threat to testing teams as they are unaware of the contracts set for the cached query. For example, a graphql query in <a href=https://www.expedia.com>expedia.com</a> would be something like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>[
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;operationName&#34;</span>: <span style=color:#e6db74>&#34;NotificationsQuery&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;variables&#34;</span>: {
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;k1&#34;</span>:<span style=color:#e6db74>&#34;v1&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;k2&#34;</span>:<span style=color:#e6db74>&#34;v2&#34;</span>
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;extensions&#34;</span>: {
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;persistedQuery&#34;</span>: {
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;version&#34;</span>: <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;sha256Hash&#34;</span>: <span style=color:#e6db74>&#34;&lt;a really long hash which you would not want on blog sites!&gt;&#34;</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>]
</span></span></code></pre></div><p>In a situation where the schema and documentations are not shared with the testing teams, one would require to either go through the codebase to view the queries being used or each out to the developer who is the owner of that particular feature/improvement.</p><p>This can become a bottleneck for fast moving teams who are pushing features day in and day out to production <em>#IYKYK</em>. This then further prompted me to work on a utility which is the subject of this article.</p><p>The solution for which I&rsquo;ll post in the <a href=https://ishabbi.tech/posts/debug-apq-extension-part2/>part-2</a> of this article.</p><hr><style>.graphql-concepts{font-family:-apple-system,BlinkMacSystemFont,segoe ui,Roboto,helvetica neue,Arial,sans-serif;max-width:1200px;margin:0 auto;padding:20px}.concepts-title{font-size:1.75rem;font-weight:300;color:#111;margin:0 0 .5rem;letter-spacing:-.5px}.concepts-subtitle{font-size:.95rem;color:#666;margin:0;font-weight:400}.concepts-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:1.5rem}.concept{border:1px solid #e5e5e5;border-radius:4px;padding:1.5rem;transition:all .2s ease;background:#fff}.concept:hover{border-color:#000;transform:translateY(-2px);box-shadow:0 4px 12px rgba(0,0,0,8%)}.concept-title{font-size:1.5rem;font-weight:600;margin:0 0 .75rem;color:#000;letter-spacing:-.2px}.concept-description{font-size:1.5rem;line-height:1.6;color:#444;margin:0}.concept-tag{display:inline-block;background:#f5f5f5;padding:2px 6px;border-radius:3px;font-family:sf mono,Monaco,courier new,monospace;font-size:.85rem;color:#555}@media(prefers-color-scheme:dark){.graphql-concepts{background:#1a1a1a}.concepts-title{color:#f5f5f5}.concepts-subtitle{color:#999}.concept{background:#1a1a1a;border-color:#333}.concept:hover{border-color:#666;box-shadow:0 4px 12px rgba(0,0,0,.3)}.concept-title{color:#f5f5f5}.concept-description{color:#b3b3b3}.concept-tag{background:#2a2a2a;color:#999}}@media(max-width:640px){.graphql-concepts{padding:15px}.concepts-grid{grid-template-columns:1fr;gap:1rem}.concept{padding:1.25rem}}</style></div></div><footer class=space-y-8><section class="series-section mt-12 mb-8"><div class="bg-neon-yellow border-4 border-black shadow-brutal p-6 md:p-8 mb-6"><h3 class="text-2xl md:text-3xl font-black text-black mb-4" id=see-also-in-graphl-automation>See also in graphl-automation
<a class="heading-link inline-block ml-2 text-neon-pink hover:text-black transition-colors" href=#see-also-in-graphl-automation><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><nav><ul class=space-y-3><li><a href=https://ishabbi.tech/posts/debug-apq-extension-part2/ class="series-link block group"><div class="bg-white border-2 border-black shadow-brutal-sm p-4 hover:bg-neon-pink hover:shadow-brutal transition-all duration-300 transform hover:-translate-x-1"><div class="flex items-center justify-between"><span class="text-lg font-black text-black group-hover:text-white transition-colors">Fetch GraphQL query from an Apollo client using APQ - Part 2</span>
<i class="fa-solid fa-arrow-right text-black group-hover:text-white group-hover:translate-x-2 transition-all"></i></div></div></a></li></ul></nav></div></section></footer><script>document.addEventListener("DOMContentLoaded",function(){typeof renderMathInElement!="undefined"&&renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"\\[",right:"\\]",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1}],throwOnError:!1})})</script></article></section></main><footer class="footer-section mt-20 mb-8"><div class="container mx-auto px-4 md:px-8"><div class="bg-black text-white border-4 border-black shadow-brutal p-8 md:p-12"><p class="text-xl md:text-2xl font-black mb-6 text-center">The scariest paths often lead to the most exciting places</p><div class="text-center text-lg font-bold">Â©
2019 -
2025
Â·
Ish Abbi</div><div class="mt-6 text-center"><div class="inline-block bg-neon-yellow text-black px-6 py-2 border-2 border-black font-black text-sm">Made with ðŸ’œ & Brutal Force
       </div></div></div></div></footer></div><script src=https://ishabbi.tech/js/coder-fix.js></script><script src=https://ishabbi.tech/js/scroll-animations.js></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-NLSP1WW1RZ"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-NLSP1WW1RZ")}</script></body></html>