<!doctype html><html lang=en><head><title>Fetch GraphQL query from an Apollo client using APQ - Part 1 · Home
</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta http-equiv=Content-Security-Policy content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self'; child-src 'self'; font-src 'self' https://fonts.gstatic.com https://cdn.jsdelivr.net/ https://rookieintraining.github.io/; form-action 'self'; frame-src 'self' https://comments.app https://rookieintraining.github.io/; img-src 'self' https://*.googletagmanager.com https://rookieintraining.github.io/; object-src 'none'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com/ https://cdn.jsdelivr.net/ https://rookieintraining.github.io/; script-src 'self' 'unsafe-inline' https://*.google-analytics.com https://*.googletagmanager.com https://comments.app https://rookieintraining.github.io/; connect-src 'self' https://*.google-analytics.com https://*.analytics.google.com https://*.googletagmanager.com https://rookieintraining.github.io/;"><meta name=author content="Ish Abbi"><meta name=description content="APIs (Application Programming Interfaces) for web applications have evolved significantly since the early days of the internet. Initially, APIs were simple and used primarily for data exchange between server and client, often through protocols like SOAP (Simple Object Access Protocol). These early APIs were cumbersome and required extensive documentation and strict adherence to protocols.
The rise of REST (Representational State Transfer) in the early 2000s marked a major shift, offering a more flexible and scalable approach to building web APIs."><meta name=keywords content="blog,developer,personal,testing,automation"><meta name=twitter:card content="summary"><meta name=twitter:title content="Fetch GraphQL query from an Apollo client using APQ - Part 1"><meta name=twitter:description content="APIs (Application Programming Interfaces) for web applications have evolved significantly since the early days of the internet. Initially, APIs were simple and used primarily for data exchange between server and client, often through protocols like SOAP (Simple Object Access Protocol). These early APIs were cumbersome and required extensive documentation and strict adherence to protocols.
The rise of REST (Representational State Transfer) in the early 2000s marked a major shift, offering a more flexible and scalable approach to building web APIs."><meta property="og:url" content="https://rookieintraining.github.io/posts/debug-apq-extension-part1/"><meta property="og:site_name" content="Home"><meta property="og:title" content="Fetch GraphQL query from an Apollo client using APQ - Part 1"><meta property="og:description" content="APIs (Application Programming Interfaces) for web applications have evolved significantly since the early days of the internet. Initially, APIs were simple and used primarily for data exchange between server and client, often through protocols like SOAP (Simple Object Access Protocol). These early APIs were cumbersome and required extensive documentation and strict adherence to protocols.
The rise of REST (Representational State Transfer) in the early 2000s marked a major shift, offering a more flexible and scalable approach to building web APIs."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-07-20T23:55:00+05:30"><meta property="article:modified_time" content="2024-07-20T23:55:00+05:30"><meta property="article:tag" content="Graphql"><meta property="article:tag" content="Apollo-Graphql"><meta property="article:tag" content="Apq"><meta property="article:tag" content="Chrome-Extensions"><meta property="article:tag" content="Debugging"><meta property="article:tag" content="Graphql-Queries"><meta property="og:see_also" content="https://rookieintraining.github.io/posts/debug-apq-extension-part2/"><link rel=canonical href=https://rookieintraining.github.io/posts/debug-apq-extension-part1/><link rel=preload href=https://rookieintraining.github.io/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=https://rookieintraining.github.io/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=https://rookieintraining.github.io/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=https://rookieintraining.github.io/css/coder.min.38c4552ac40f9ae3408bad40358f654ebd8804412fe74ed56f2d6c8a7af82dd3.css integrity="sha256-OMRVKsQPmuNAi61ANY9lTr2IBEEv507Vby1sinr4LdM=" crossorigin=anonymous media=screen><link rel=stylesheet href=https://rookieintraining.github.io/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=https://rookieintraining.github.io/images/favicon.svg sizes=any><link rel=icon type=image/png href=https://rookieintraining.github.io/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://rookieintraining.github.io/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=https://rookieintraining.github.io/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=https://rookieintraining.github.io/images/apple-touch-icon.png><link rel=manifest href=https://rookieintraining.github.io/site.webmanifest><link rel=mask-icon href=https://rookieintraining.github.io/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=https://rookieintraining.github.io/>Home
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=https://rookieintraining.github.io/posts/>Blog</a></li><li class=navigation-item><a class=navigation-link href=https://rookieintraining.github.io/aboutme/>About</a></li><li class=navigation-item><a class=navigation-link href=https://rookieintraining.github.io/contactme/>Contact me</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://rookieintraining.github.io/posts/debug-apq-extension-part1/>Fetch GraphQL query from an Apollo client using APQ - Part 1</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa-solid fa-calendar" aria-hidden=true></i>
<time datetime=2024-07-20T23:55:00+05:30>July 20, 2024
</time></span><span class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>
5-minute read</span></div><div class=categories><i class="fa-solid fa-folder" aria-hidden=true></i>
<a href=https://rookieintraining.github.io/categories/test-automation/>Test Automation</a></div><div class=tags><i class="fa-solid fa-tag" aria-hidden=true></i>
<span class=tag><a href=https://rookieintraining.github.io/tags/graphql/>Graphql</a>
</span><span class=separator>•</span>
<span class=tag><a href=https://rookieintraining.github.io/tags/apollo-graphql/>Apollo-Graphql</a>
</span><span class=separator>•</span>
<span class=tag><a href=https://rookieintraining.github.io/tags/apq/>Apq</a>
</span><span class=separator>•</span>
<span class=tag><a href=https://rookieintraining.github.io/tags/chrome-extensions/>Chrome-Extensions</a>
</span><span class=separator>•</span>
<span class=tag><a href=https://rookieintraining.github.io/tags/debugging/>Debugging</a>
</span><span class=separator>•</span>
<span class=tag><a href=https://rookieintraining.github.io/tags/graphql-queries/>Graphql-Queries</a></span></div></div></header><div class=post-content><p><strong>APIs (Application Programming Interfaces)</strong> for web applications have evolved significantly since the early days of the internet. Initially, APIs were simple and used primarily for data exchange between server and client, often through protocols like SOAP (Simple Object Access Protocol). These early APIs were cumbersome and required extensive documentation and strict adherence to protocols.</p><p>The rise of <strong>REST (Representational State Transfer)</strong> in the early 2000s marked a major shift, offering a more flexible and scalable approach to building web APIs. RESTful APIs leverage standard HTTP methods, making them easier to use and more intuitive. However, 2015 saw a paradigm shift, Facebook (now Meta Inc.) introduced <strong>GraphQL</strong> to the world, allowing clients to request specific data, resulting to it&rsquo;s rapid adoption amongst enterprises. According to reports, it is projected that by 2025, <em>over 50% of enterprises will use GraphQL in production, up from less than 10% in 2021</em>.</p><hr><h1 id=graphql-101>Graphql 101
<a class=heading-link href=#graphql-101><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h1><p>For those who are new to GraphQL, I&rsquo;ll highlight some of the key concepts used below:</p><table><thead><tr><th><strong>Key Concept</strong></th><th><strong>Description</strong></th></tr></thead><tbody><tr><td><strong>Schema</strong></td><td>The schema defines the structure of the API, specifying types, queries, mutations, and subscriptions. It serves as a contract between the client and server.</td></tr><tr><td><strong>Types</strong></td><td>GraphQL uses various types such as <code>Scalar</code>, <code>Object</code>, <code>Enum</code>, <code>Union</code>, and <code>Interface</code> to define the shape of the data and the relationships between different data fields.</td></tr><tr><td><strong>Queries</strong></td><td>Queries are used to fetch data from the server. They specify what data is needed and can include nested fields to retrieve related data in a single request.</td></tr><tr><td><strong>Mutations</strong></td><td>Mutations are used to modify data on the server. They allow clients to perform actions like creating, updating, or deleting data.</td></tr><tr><td><strong>Subscriptions</strong></td><td>Subscriptions enable real-time updates by allowing clients to listen for specific events and receive updates when those events occur.</td></tr><tr><td><strong>Resolvers</strong></td><td>Resolvers are functions that handle the logic for fetching the data specified in queries, mutations, and subscriptions. They map schema fields to data sources.</td></tr><tr><td><strong>Fields</strong></td><td>Fields are the individual pieces of data that can be queried within a type. Each field can have arguments, making the queries flexible and dynamic.</td></tr><tr><td><strong>Arguments</strong></td><td>Arguments allow clients to pass parameters to fields, enabling the customization of the data fetched by queries and mutations.</td></tr><tr><td><strong>Directives</strong></td><td>Directives provide a way to modify the behavior of queries, such as including or skipping fields based on conditions (<code>@include</code> and <code>@skip</code>).</td></tr><tr><td><strong>Fragments</strong></td><td>Fragments allow the reuse of parts of queries and mutations. They help in structuring queries and reducing redundancy by defining reusable units of selection sets.</td></tr><tr><td><strong>Introspection</strong></td><td>Introspection is a feature that allows clients to query the schema itself to understand the types, fields, and operations available, aiding in API exploration and documentation.</td></tr></tbody></table><p>For further reading, you can go through the getting started present <a href=https://graphql.org/learn/ class=external-link target=_blank rel=noopener>here</a></p><p>As discussed earlier, graphql&rsquo;s strengths is its ability to fetch exactly the data needed. This can however, also lead to issues if not managed correctly. Over-querying can occur if clients request too much data, impacting performance. Under-querying, where not enough data is requested, might require multiple requests to fulfill a need, which could negate some of the benefits of using GraphQL​.</p><p>Also, in order to avoid under and over-fetching, developers might resort to creating complex queries containing multiple fragments which increases the size of the payload that needs to be sent to the network which again impacts the performance of the application.</p><p>And this is where we are introduced to the <strong><em>Apollo Client</em></strong>.</p><hr><h1 id=apollo-client-and-apq>Apollo Client and APQ
<a class=heading-link href=#apollo-client-and-apq><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h1><p>As per their current documentation:</p><blockquote>Apollo provides the developer platform and tools to unify your data and services into a supergraph—a single distributed GraphQL API.
Apollo makes GraphQL work for you at any stage and any scale, whether you're just getting started, building your first API, querying an API, or migrating your platform onto the supergraph.</blockquote><p>Apollo GraphQL Client provides several features that help overcome the limitations of GraphQL, enhancing the development experience and performance of GraphQL-based applications. The discussion for which is limited to <strong>Automatic persisted queries or APQ</strong></p><blockquote>A persisted query is a query string that's cached on the server side, along with its unique identifier (always its SHA-256 hash). Clients can send this identifier instead of the corresponding query string, thus reducing request sizes dramatically (response sizes are unaffected).<p>To persist a query string, Apollo Server must first receive it from a requesting client. Consequently, each unique query string must be sent to Apollo Server at least once. After any client sends a query string to persist, every client that executes that query can then benefit from APQ.</p></blockquote><p>Now, this works wonders in boosting the performance of the application. But, does pose a threat to testing teams as they are unaware of the contracts set for the cached query. For example, a graphql query in <a href=https://www.expedia.com class=external-link target=_blank rel=noopener>expedia.com</a> would be something like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>[
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;operationName&#34;</span>: <span style=color:#e6db74>&#34;NotificationsQuery&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;variables&#34;</span>: {
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;k1&#34;</span>:<span style=color:#e6db74>&#34;v1&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;k2&#34;</span>:<span style=color:#e6db74>&#34;v2&#34;</span>
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;extensions&#34;</span>: {
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;persistedQuery&#34;</span>: {
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;version&#34;</span>: <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;sha256Hash&#34;</span>: <span style=color:#e6db74>&#34;&lt;a really long hash which you would not want on blog sites!&gt;&#34;</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>]
</span></span></code></pre></div><p>In a situation where the schema and documentations are not shared with the testing teams, one would require to either go through the codebase to view the queries being used or each out to the developer who is the owner of that particular feature/improvement.</p><p>This can become a bottleneck for fast moving teams who are pushing features day in and day out to production <em>#IYKYK</em>. This then further prompted me to work on a utility which is the subject of this article.</p><p>The solution for which I&rsquo;ll post in the <a href=https://rookieintraining.github.io/posts/debug-apq-extension-part2>part-2</a> of this article.</p><hr></div><footer><section class=see-also><h3 id=see-also-in-graphl-automation>See also in graphl-automation
<a class=heading-link href=#see-also-in-graphl-automation><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><nav><ul><li><a href=https://rookieintraining.github.io/posts/debug-apq-extension-part2/>Fetch GraphQL query from an Apollo client using APQ - Part 2</a></li></ul></nav></section><div class=comments><script>let s=document.createElement("script");s.src="https://comments.app/js/widget.js?3",s.setAttribute("data-comments-app-website","SctzjgQq"),s.setAttribute("data-limit","10"),s.setAttribute("data-height","auto"),s.setAttribute("data-color",""),s.setAttribute("data-dislikes",""),s.setAttribute("data-outlined",""),s.setAttribute("data-colorful",""),s.setAttribute("data-dark",""),document.querySelector("div.comments").innerHTML="",document.querySelector("div.comments").appendChild(s)</script></div></footer></article></section></div><footer class=footer><section class=container><p>The scariest paths often lead to the most exciting places</p>©
2019 -
2024
·
Ish Abbi</section></footer></main><script src=https://rookieintraining.github.io/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-NLSP1WW1RZ"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-NLSP1WW1RZ")}</script></body></html>